{% extends 'base.html' %}
{% load form_extras %}
{% block content %}
  <h2>{% if post %}Edit Post{% else %}New Post{% endif %}</h2>
  <form method="post" enctype="multipart/form-data">{% csrf_token %}
    {% if form.non_field_errors %}
      <div class="alert alert-danger">{{ form.non_field_errors }}</div>
    {% endif %}
    <div class="mb-3">
      <label class="form-label">Category</label>
      {{ form.category|add_class:'form-select' }}
      {% if form.category.errors %}<div class="text-danger small">{{ form.category.errors|join:', ' }}</div>{% endif %}
    </div>
    <div class="mb-3">
      <label class="form-label">Title</label>
      {{ form.title|add_class:'form-control' }}
      {% if form.title.errors %}<div class="text-danger small">{{ form.title.errors|join:', ' }}</div>{% endif %}
    </div>
    <div class="mb-3">
      <label class="form-label">Content</label>
      {{ form.content|add_class:'form-control' }}
      {% if form.content.errors %}<div class="text-danger small">{{ form.content.errors|join:', ' }}</div>{% endif %}
    </div>
    <div class="mb-3">
      <label class="form-label">Tags</label>
      <input type="text" name="tags" class="form-control" placeholder="tag1, tag2" value="{{ request.POST.tags|default:'' }}">
      <div class="form-text">Pisahkan dengan koma. Contoh: tips,python</div>
    </div>
    <div class="mb-3">
      <label class="form-label">Attachment (optional)</label>
      {{ form.attachment }}
      {% if form.attachment.errors %}<div class="text-danger small">{{ form.attachment.errors|join:', ' }}</div>{% endif %}
      <div class="form-text">Or paste a URL</div>
      {{ form.attachment_url|add_class:'form-control' }}
      {% if form.attachment_url.errors %}<div class="text-danger small">{{ form.attachment_url.errors|join:', ' }}</div>{% endif %}
    </div>
    <button class="btn btn-primary">Save</button>
  </form>
  <!-- EasyMDE for Markdown (CDN) -->
  <link rel="stylesheet" href="https://unpkg.com/easymde/dist/easymde.min.css">
  <script src="https://unpkg.com/easymde/dist/easymde.min.js"></script>
  <script>
    const ta = document.querySelector('textarea.markdown-input');
    if (ta) {
      new EasyMDE({ element: ta, spellChecker: false, status: false });
    }
  </script>
{% endblock %}
